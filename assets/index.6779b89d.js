import{c as v,t as a,d as w,a as s,S as _,o as k,b as C,e as F,i as u,F as $,s as d,l as j,m as B,f,g as A,h as x,j as E,k as D,r as I}from"./vendor.7317c0a5.js";const L=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))t(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function o(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerpolicy&&(r.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?r.credentials="include":l.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(l){if(l.ep)return;l.ep=!0;const r=o(l);fetch(l.href,r)}};L();const P=()=>{const[n,e]=v([]);return{foodSelection:n,addFood:o=>e(t=>t.some(l=>l.code==o.code)?t:[...t,o]),deleteFood:o=>e(t=>t.filter(l=>l.code!==o.code)),resetFoodSelection:()=>e([])}},{foodSelection:g,addFood:y,deleteFood:O,resetFoodSelection:ve}=P(),M=a('<button class="w-16 h-10 bg-gray-200 rounded focus:outline-none focus:bg-gray-300 hover:bg-gray-300"><img class="object-cover p-2 " src="./assets/scan.svg" alt=""></button>'),H=a('<video class="w-full h-full" autoplay></video>'),z=a('<div class="overflow-x-hidden overflow-y-auto fixed inset-0 z-50 justify-center items-center"><button class="p-1 ml-auto bg-transparent border-0 text-gray-300 float-right text-3xl leading-none font-semibold outline-none focus:outline-none"><span class="bg-transparent h-6 w-6 text-2xl block outline-none focus:outline-none">X<i class="fas fa-times"></i></span></button></div>'),R="https://world.openfoodfacts.org/api/v0/product/";function S(){const[n,e]=v(""),[o,t]=v(!1),l=async r=>{e(r);const c=await(await fetch(`${R}${r}.json`)).json();c.status===1&&(y(c),t(!1))};return s(_,{when:!0,get children(){return[(()=>{const r=M.cloneNode(!0);return r.$$click=()=>t(!0),r})(),s(_,{get when(){return o()},get children(){return s(U,{close:()=>t(!1),get children(){return s(q,{onDetection:l})}})}})]}})}function q(n){let e,o;k(()=>{t(),l()}),C(()=>window.clearInterval(o));const t=async()=>{const r=await navigator.mediaDevices.getUserMedia({audio:!1,video:{width:{ideal:1920},height:{ideal:1080},facingMode:{ideal:"environment"}}});e.srcObject=r,await e.play()},l=()=>{if(!("BarcodeDetector"in window))return;const r=new S(["code_39","codabar","ean_13","ean_14"]);console.log(r),console.log(r.detect),o=window.setInterval(async()=>{const i=await r.detect(e);if(i.length<=0)return;let c=i[0].rawValue;console.log(c),n.onDetection(c)},1e3)};return(()=>{const r=H.cloneNode(!0),i=e;return typeof i=="function"?i(r):e=r,r})()}function U(n){return(()=>{const e=z.cloneNode(!0),o=e.firstChild;return F(o,"click",n.close,!0),u(e,()=>n.children,null),e})()}w(["click"]);const V=a('<header class="fixed bg-white w-full z-30 top-0 border-b "><div class="container max-w-5xl mx-auto p-2 flex items-center mt-0 gap-2"><img class="apsect-square h-11" src="./assets/brocoli.svg" alt="logo"><h3>Brocoli</h3></div></header>'),K=a('<form class="flex ml-auto"><input type="text" id="barcode" name="barcode" class="appearance-none border-2 border-gray-200 rounded-tl rounded-bl w-40 py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500"><input type="submit" value="Search" class="w-16 md:w-30 rounded-tr rounded-br focus:outline-none focus:bg-gray-300 hover:bg-gray-300 cursor-pointer"></form>'),W=a('<section class="bg-white pt-20 pb-2 center"><ul class="container max-w-3xl mx-auto flex gap-2 px-2"></ul></section>'),X=a('<li class="flex flex-wrap content-center"></li>'),G=a('<button class="group relative focus:outline-none"><img class="object-cover w-12 h-12 rounded-full border border-gray-100 shadow-sm" alt="loading"><div class="hidden absolute top-0 right-0 h-3 w-3 my-1 border-1 border-white rounded-full bg-red-400 z-2 transform group-hover:scale-150 group-hover:block group-focus:scale-150 group-focus:block"></div><div class="hidden absolute -left-10 top-12 w-50 flex-col  group-hover:flex group-focus:flex"><div class="w-full overflow-hidden inline-block"><div class="h-4 w-4 border rotate-45 transform origin-bottom-left ml-13"></div></div><div class="p-2 text-left text-gray-600 border rounded shadow"></div></div></button>'),J=a('<section class="container max-w-3xl mx-auto pt-8 flex flex-col gap-10"></section>'),Q=a('<div class="flex flex-col px-2 text-gray-600"><svg height="100%" width="100%" viewBox="0 0 500 70" preserveAspectRatio="none"><g stroke-width=".5"><g></g></g></svg><span class="mx-auto"></span></div>'),T=a('<svg><g class="axis"></g></svg>',4,!0),Y=a('<svg height="0" width="0"><defs></defs></svg>'),Z=a('<svg><pattern patternUnits="objectBoundingBox" x="0" y="0" height="1" width="1"><image height="24" width="24" preserveAspectRatio="none"></image></pattern></svg>',6,!0),ee=a('<svg><circle cy="10" r="13" fill="white"></circle></svg>',4,!0),te=a('<svg><circle cy="10" r="12"></circle></svg>',4,!0),ne="https://world.openfoodfacts.org/api/v0/product/",re=["energy-kcal_100g","carbohydrates_100g","sugars_100g","fat_100g","saturated-fat_100g","fiber_100g","proteins_100g","salt_100g","sodium_100g","carbon-footprint-from-known-ingredients_100g"],oe=()=>[s(ie,{}),s(_,{get when(){return g().length},get children(){return[s(ae,{}),s(de,{})]}})];w(["input","keydown"]);function le(n,e){const[o,t]=e();f(()=>n.value=o()),n.$$input=l=>t(l.target.value)}function se(n){n.$$keydown=e=>isNaN(e.key)&&e.key in["Enter","tab","return"]&&e.preventDefault()}const ie=()=>(()=>{const n=V.cloneNode(!0),e=n.firstChild;return e.firstChild.nextSibling,u(e,s(ce,{}),null),u(e,s(S,{}),null),n})();function ce(){const[n,e]=v("0737628064502");async function o(t){t.preventDefault();const r=await(await fetch(`${ne}${n()}.json`)).json();r.status===1&&(y(r),e(""))}return(()=>{const t=K.cloneNode(!0),l=t.firstChild;return t.addEventListener("submit",o),se(l),le(l,()=>[n,e]),t})()}function ae(){return(()=>{const n=W.cloneNode(!0),e=n.firstChild;return u(e,s($,{get each(){return g()},children:o=>(()=>{const t=X.cloneNode(!0);return u(t,s(ue,{get product(){return o.product}})),t})()})),n})()}function ue(n){const{image_thumb_url:e,_id:o,product_name:t,product_name_fr:l}=n.product;return(()=>{const r=G.cloneNode(!0),i=r.firstChild,c=i.nextSibling,h=c.nextSibling,m=h.firstChild,p=m.nextSibling;return d(i,"src",e),c.$$click=()=>O({code:o}),u(p,t||l),r})()}function de(){return(()=>{const n=J.cloneNode(!0);return u(n,s(he,{}),null),u(n,s($,{each:re,children:e=>s(fe,{nutriment:e})}),null),n})()}function fe(n){const e=60,o=500,t={top:5,bottom:5,left:15,right:15},l=e-t.top-t.bottom,r=o-t.left-t.right;let i=j().domain([0,Math.max(B(g(),c=>c.product?.nutriments?.[n.nutriment]*1.1),100)]).range([0,r]);return(()=>{const c=Q.cloneNode(!0),h=c.firstChild,m=h.firstChild,p=m.firstChild,N=h.nextSibling;return u(p,s($,{get each(){return g()},children:b=>s(_,{get when(){return b.product?.nutriments?.[n.nutriment]},get children(){return s(me,{get code(){return b.code},get value(){return b.product.nutriments[n.nutriment]}})}})}),null),u(p,s(ge,{innerHeight:l,scale:i}),null),u(N,()=>n.nutriment.replaceAll(/[-_]/ig," ")),f(()=>d(m,"transform",`translate(${t.left},${t.top})`)),c})()}function ge(n){let e;return A(()=>{x(e).selectAll("*").remove();let o=E(n.scale).tickSizeOuter(0);x(e).call(o)}),(()=>{const o=T.cloneNode(!0),t=e;return typeof t=="function"?t(o):e=o,f(()=>d(o,"transform",`translate(0, ${n.innerHeight-20})`)),o})()}function he(){return(()=>{const n=Y.cloneNode(!0),e=n.firstChild;return u(e,s($,{get each(){return g()},children:o=>(()=>{const t=Z.cloneNode(!0),l=t.firstChild;return f(r=>{const i=o.code,c=o.product.image_thumb_url;return i!==r._v$&&d(t,"id",r._v$=i),c!==r._v$2&&D(l,"http://www.w3.org/1999/xlink","xlink:href",r._v$2=c),r},{_v$:void 0,_v$2:void 0}),t})()})),n})()}function me(n){return[(()=>{const e=ee.cloneNode(!0);return f(()=>d(e,"cx",n.value)),e})(),(()=>{const e=te.cloneNode(!0);return f(o=>{const t=n.value,l=`url(#${n.code})`;return t!==o._v$3&&d(e,"cx",o._v$3=t),l!==o._v$4&&d(e,"fill",o._v$4=l),o},{_v$3:void 0,_v$4:void 0}),e})()]}w(["click"]);I(()=>s(oe,{}),document.getElementById("root"));
